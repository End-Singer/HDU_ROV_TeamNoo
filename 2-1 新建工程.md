# 新建工程
## 基于寄存器开发
 1. 选择芯片型号STM32F03C8
 2. STM32启动文件地址，放入工程文件夹，新建一个start文件夹
>`固件库\STM32F10x_StdPeriph_Lib_V3.5.0\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x\startup\arm`
3. 外设寄存器描述文件以及两个配置时钟文件，也放入start
> 固件库\STM32F10x_StdPeriph_Lib_V3.5.0\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x
4. 内核寄存器描述文件，也放入start
> D:\水机\江科大科协\固件库\STM32F10x_StdPeriph_Lib_V3.5.0\Libraries\CMSIS\CM3\CoreSupport
5. 把source group1文件夹改成start，右键选择添加已经存在的文件到组里，选择型号md.s以及剩下的.c和.h文件
6. 在工程选项里添加头文件路径，打开工程选项（魔术棒），在C/C++里include paths栏添加路径
7. 在工程目录新建User文件夹；keil里target右键添加组并改名User；右键User添加新文件，选择C命名main；main.c`int返回型、void参数的函数`里右键插入头文件；写一个main函数和while(1)死循环最后一行留空行
8. 扳手工具 encoding 选择 UTF-8 防止中文乱码
### 寄存器点灯
1. 连接STM32+STlink+电脑，正常状态： 电源灯常亮，PC13灯闪烁
2. keil	调试器（扳手）	debug	 改成stlink debugger；再点右侧下载按钮 在 flash download 勾选 reset and run（下载程序后立刻复位并执行）
3. **二极管绝对绝对不可以直接连面包板的正负极，今后二极管也绝对不能直接连接到了电源的两端！！！必须要有限流电阻，VCC-3.3V直接连接电流可达500mA-1A，而二极管的电阻很小最大只能承受20-30mA的持续电流，故导致烧毁二极管。**
>**TIPS: 配置RCC时钟，就像是给整个单片机芯片的“心脏”和“神经脉络”通电。** 如果不配置，CPU、内存、外设（比如GPIO）都处于“休眠”状态，没有动力来源，你写的任何点灯代码都无法被执行。
>**GPIO 通用输入/输出端口，是微控制器芯片上一系列可以被程序控制的引脚**
## 基于固件库开发
### 操作STM32的GPIO总共3个步骤
1. 使用RCC开启GPIO时钟
2. 使用GPIO_Init函数初始化GPIO
3. 使用输入&输出函数控制GPIO口
>查看外设库函数在library找到如rcc.h；.h最下面一般都是所有函数的声明
>rcc里最常用的设置：AHB高速总线、APB1重要外设、APB2普通外设
# 新建工程步骤
1. 建立工程文件夹，keil中新建工程，选择型号
2. 在工程文件夹建立Start、Library、User、Hardware、System等文件夹，复制固件库里面的文件到工程文件夹里
3. 工程量对应建立Start、Library、User、Hardware、System等同名称分组，将文件夹中的文件添加到工程分组里
4. 工程选项，C/C++，Include Paths内声明所有包含头文件的文件夹
5. 工程选项，C/C++，Define内定义USE_STDPERIPH_DRIVER
6. 工程选项，Debug，下拉列表选择对应调试器，Settings，Flash Download勾选Reset and Run
## 工程架构
![输入图片说明](/imgs/2025-11-13/GMbvNRUmlbn66R21.png)
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTQ5NzQ2NTI2MV19
-->